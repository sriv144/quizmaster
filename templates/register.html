{% extends "base.html" %}
{% block title %}Register - Quiz Master{% endblock %}

{% block content %}
<h3 class="text-center mb-4 text-white">Welcome to Quiz Master</h3>
<h5 class="text-center mb-4 text-white">Registration</h5>
<form method="POST" action="{{ url_for('app_routes.register') }}" id="registerForm" novalidate>
  <div class="mb-3">
    <label for="username" class="form-label text-white">User name (E-mail):</label>
    <input type="email" class="form-control" id="username" name="username" required placeholder="Enter your Gmail (e.g. example@gmail.com)">
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <div class="mb-3">
    <label for="password" class="form-label text-white">Password:</label>
    <input type="password" class="form-control" id="password" name="password" required placeholder="Enter your password">
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <div class="mb-3">
    <label for="confirm_password" class="form-label text-white">Confirm Password:</label>
    <input type="password" class="form-control" id="confirm_password" name="confirm_password" required placeholder="Re-enter your password">
    <div id="password_match_msg" class="form-text text-warning"></div>
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <div class="mb-3 form-check">
    <input type="checkbox" class="form-check-input" id="show_password">
    <label class="form-check-label text-white" for="show_password">Show Password</label>
  </div>
  <div class="mb-3">
    <label for="full_name" class="form-label text-white">Full Name:</label>
    <input type="text" class="form-control" id="full_name" name="full_name" required placeholder="Enter your full name">
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <div class="mb-3">
    <label for="dob" class="form-label text-white">Date of Birth:</label>
    <input type="date" class="form-control" id="dob" name="dob" required>
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <div class="mb-3">
    <label for="contact_no" class="form-label text-white">Contact Number:</label>
    <input type="text" class="form-control" id="contact_no" name="contact_no" required placeholder="Enter your contact number">
    <div class="invalid-feedback">
      This field is required.
    </div>
  </div>
  <!-- Checkbox for Admin role -->
  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" id="is_admin" name="is_admin" value="yes">
    <label class="form-check-label text-white" for="is_admin">I am an admin</label>
  </div>
  <button type="submit" class="btn btn-primary w-100">Submit</button>
</form>
<div class="text-center mt-3">
  <a href="{{ url_for('app_routes.login') }}" class="text-info">Existing user? Log in</a>
</div>

<script>
  // Show/Hide Password functionality
  document.getElementById('show_password').addEventListener('change', function() {
    const passField = document.getElementById('password');
    const confField = document.getElementById('confirm_password');
    const type = this.checked ? 'text' : 'password';
    passField.type = type;
    confField.type = type;
  });

  // Dynamic password match check
  const passwordField = document.getElementById('password');
  const confirmField = document.getElementById('confirm_password');
  const matchMsg = document.getElementById('password_match_msg');
  function checkPasswordMatch() {
    if (passwordField.value !== confirmField.value) {
      matchMsg.textContent = "Passwords do not match.";
    } else {
      matchMsg.textContent = "";
    }
  }
  passwordField.addEventListener('input', checkPasswordMatch);
  confirmField.addEventListener('input', checkPasswordMatch);

  // Bootstrap custom validation for the registration form
  (function () {
    'use strict'
    var form = document.getElementById('registerForm');
    form.addEventListener('submit', function (event) {
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
      }
      form.classList.add('was-validated')
    }, false)
  })()
</script>
{% endblock %}
